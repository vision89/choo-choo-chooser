<!doctype html>
<html lang="">
	
	<head>

		<!--<link rel="icon" href="assets/favicon.ico" type="image/x-icon" />-->

		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<!-- Web Components -->
		<script src="/bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>

		<!-- MDL -->
		<link rel="stylesheet" href="/bower_components/material-design-lite/material.min.css">
		<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

		<!--Local Styles -->
		<link rel="stylesheet" href="css/styles.css">
		
		<!-- Elements -->
		<link rel="import" href="elements/elements.html">

		<!-- Polyfills -->
		<!--[if IE 8]><script src="/bower_components/EventListener/EventListener.js"></script><!--<![endif]-->
		<!--[if lt IE 8]><script src="/bower_components/EventListener/EventListener.oldie.js"></script><!--<![endif]-->
		<script src="/bower_components/cache-polyfill/index.js"></script>
		
		<!-- Any styles were sharing -->
		<style is="custom-style" include="shared-styles"></style>

		<title>Choo Choo Chooser!</title>

	</head>

	<body class="fullbleed layout vertical" unresolved>

		<template id="app" is="dom-bind">

			<paper-drawer-panel id="paperDrawerPanel" force-narrow="true" disable-edge-swipe="true">

				<paper--header-panel drawer>

					<!-- Drawer Toolbar -->
					<paper-toolbar id="drawerToolbar">

						<span>Menu</span>

					</paper-toolbar>
					
					<!-- Were grabbing values -->
					<template is="dom-if" if="[[loading]]">
						
						<div class="horizontal_center vertical_center">

							<paper-spinner active></paper-spinner>

						</div>

					</template>

					<!-- We have the values -->
					<template is="dom-if" if="[[!loading]]">

						<!-- Selectable stations go here -->
						<paper-listbox selected="0">

							<template is="dom-repeat" items="[[gtfsJson.agencyList]]">

								<paper-item>[[item._attr.Name._value]]</paper-item>

							</template>

						</paper-listbox>

					</template>

				</paper--header-panel>
				
				<!-- Top Header -->
				<paper--header-panel main>

					<paper-toolbar id="main-toolbar">

						<div class="middle middle-container">

							<div class="app-name">Choo Choo Chooser!</div>

						</div>

					</paper-toolbar>

					<div class="content">

						<neon-animated-pages class="flex" selected="[[selected]]">

							<map-page class="choosey-card-offline" on-destination-pressed="populateDestination" on-departure-pressed="populateDeparture" departure="{{departure}}" destination="{{destination}}" is-mobile="[[mobile]]" is-online="[[online]]"></map-page>

							<schedule-page></schedule-page>
						    
						</neon-animated-pages>

					</div>

				</paper--header-panel>

			</paper-drawer-panel>

			<iron-media-query query="(max-width: 767px)" query-matches="{{mobile}}"></iron-media-query>
			
			<!-- Load a new serice worker -->
			<paper-toast id="reloadtoast" duration="13000" text="A new version of Choo Choo Chooser is available, ">

				<paper-button class="pink-button" onclick="[[reloadPage]]">Update!</paper-button>

			</paper-toast>

			<!-- Make json data from gtfs files -->
			<gtfs-feed id="gtfsfiles" files="[[files]]" json="{{filesJson}}" on-json-updated="updatedJsonFiles" on-error="gtfsErrorFiles"></gtfs-feed>
			
			<!-- Make json data from agency xml -->
			<gtfs-feed id="gtfsagency" xml="[[agencytext]]" json="{{gtfsJson}}" on-json-updated="updatedAgencyXML" on-error="gtfsErrorXML"></gtfs-feed>


		</template>

		<!-- indexeddb shim -->
		<script src="bower_components/IndexedDBShim/dist/indexeddbshim.min.js"></script>

		<!-- IndexedDB Promised -->
		<script src="bower_components/indexeddb-promised/lib/idb.js"></script>

		<!-- App Logic -->
		<script src="js/all.js"></script>

	</body>

</html>