<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/neon-animation/neon-animatable-behavior.html">
<link rel="import" href="../bower_components/neon-animation/animations/slide-from-left-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/slide-left-animation.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">

<dom-module id="map-page">

	<style>

	    :host {
	      display: block;
	      height: 70em;
	    }

	    .choosy-card-mobile-online {
			
			--paper-card-header-color: white;
	    	@apply(--choosy-card-theme-mobile-online);

	    }

	    .choosy-card-mobile-offline {
			
			--paper-card-header-color: white;
			top: 5em;
			z-index: 1;
			width: 90%;
			margin-left: auto;
			margin-right: auto;
			display: block;
			@apply(--choosy-card-theme-mobile-offline);

	    }

	    .choosy-card-wide-online {
			
			--paper-card-header-color: white;
	    	position: absolute;
			top: 5em;
			right: 2em;
			z-index: 1;
			@apply(--choosy-card-theme-wide-online);

	    }

	    .choosy-card-wide-offline {
			
			--paper-card-header-color: white;
			top: 5em;
			z-index: 1;
			width: 50%;
			margin-left: auto;
			margin-right: auto;
			display: block;
			@apply(--choosy-card-theme-wide-offline);

	    }

	</style>
	
	<template>

		<paper-card id="inputcard" heading="Choose a departure and destination" class$="[[_cardClass]]" image="../assets/images/stock-photo-46082604-fast-train-with-motion-blur.jpg">

			<div class="card-content">
				
				<!-- Departure -->
				<div class="mdl-grid">

					<div class="mdl-cell mdl-cell--10-col mdl-cell--12-col-tablet mdl-cell--12-col-phone">

						<paper-input id="departure" label="Click + to select a departure station" disabled="true" error-message="Required" required></paper-input>

					</div>

					<div class="mdl-cell mdl-cell--2-col mdl-cell--12-col-tablet mdl-cell--12-col-phone">

						<paper-fab suffix icon="add" paper-drawer-toggle on-click="populateDeparture"</paper-fab>

					</div>

				</div>
				
				<!-- Destination -->
				<div class="mdl-grid">	

					<div class="mdl-cell mdl-cell--10-col mdl-cell--12-col-tablet mdl-cell--12-col-phone">
						
						<paper-input id="destination" label="Click + to select a destination station" disabled="true" error-message="Required" required></paper-input>

					</div>

					<div class="mdl-cell mdl-cell--2-col mdl-cell--12-col-tablet mdl-cell--12-col-phone">
						
						<paper-fab suffix icon="add" paper-drawer-toggle on-click="populateDestination"></paper-fab>

					</div>

				</div>

			</div>

			<div class="card-actions">



			</div>

		</paper-card>
		
		<div class="flex layout vertical">

			<google-map disable-default-ui="true" hidden$="[[!isOnline]]"></google-map>

		</div>

	</template>    

</dom-module>

<script>
	'use strict';

	Polymer({

	    is: 'map-page',

	    behaviors: [Polymer.NeonAnimatableBehavior],

	    properties: {

	    	/**
	    	 * Helps with loading/unloading card
	    	 * @type {Object}
	    	 */
	    	animationConfig: {
	    		value: function() {

	    			return {

	    				'entry': {
	    					name: 'slide-from-left-animation',
	    					node: this
	    				},

	    				'exit': {
	    					name: 'slide-left-animation',
	    					node: this
	    				}

	    			}

	    		}
	    	},

	    	/**
	    	 * Departure train
	    	 * @type {string}
	    	 */
	    	departure: {

	    		type: String,
		        notify: true,
		        value: ''

	    	},

	    	/**
	    	 * Destination train
	    	 * @type {string}
	    	 */
	    	destination: {

	    		type: String,
		        notify: true,
		        value: ''

	    	},

	    	/**
	    	 * Are we a mobile device?
	    	 * @type {Boolan}
	    	 */
	    	isMobile: {

	    		type: Boolean,
	    		notify: false,
	    		value: false,
	    		observer: '_setStyle'

	    	},

	    	/**
	    	 * Are we online?
	    	 * @type {Boolean}
	    	 */
	    	isOnline: {

	    		type: Boolean,
	    		notify: false,
	    		value: true,
	    		observer: '_setStyle'

	    	},

	    	/**
	    	 * Class name to apply to the card
	    	 * @type {String}
	    	 */
	    	_cardClass: {

	    		type: String,
	    		notify: false,
	    		value: 'choosy-card-wide-online'

	    	}

	    },

	    /**
	     * Called on destination button press
	     * 
	     */
	    populateDestination: function() {

	    	this.fire('destination-pressed');

	    },

	    /**
	     * Called on departure button press
	     * 
	     */
	    populateDeparture: function() {

	    	this.fire('departure-pressed');

	    },

	    /**
	     * Called when width is set
	     */
	    _setStyle: function() {

	    	if(this.isMobile && this.isOnline) {

	    		this._cardClass = 'choosy-card-mobile-online';

	    	} else if(this.isMobile && !this.isOnline) {

	    		this._cardClass = 'choosy-card-mobile-offline';

	    	} else if(!this.isMobile && this.isOnline) {

	    		this._cardClass = 'choosy-card-wide-online';

	    	} else {

	    		this._cardClass = 'choosy-card-wide-offline';

	    	}

	    	this.$.inputcard.updateStyles();

	    },

	    // Element Lifecycle

	    ready: function() {
	      // `ready` is called after all elements have been configured, but
	      // propagates bottom-up. This element's children are ready, but parents
	      // are not.
	      //
	      // This is the point where you should make modifications to the DOM (when
	      // necessary), or kick off any processes the element wants to perform.

	    },

	    attached: function() {
	      // `attached` fires once the element and its parents have been inserted
	      // into a document.
	      //
	      // This is a good place to perform any work related to your element's
	      // visual state or active behavior (measuring sizes, beginning animations,
	      // loading resources, etc).

	    },

	    detached: function() {
	      // The analog to `attached`, `detached` fires when the element has been
	      // removed from a document.
	      //
	      // Use this to clean up anything you did in `attached`.

	    }
	    
	});    	

</script>